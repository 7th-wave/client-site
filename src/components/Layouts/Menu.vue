<template>
  <div
    class="
      px-4
      sm:px-0
      font-inter
      flex-1 flex flex-col
      min-h-0
      bg-white
      font-medium
      rounded-lg
    "
  >
    <div class="flex-1 flex flex-col pt-5 pb-4 overflow-y-auto">
      <div class="flex items-center flex-shrink-0 px-4">
        <a href="/">
          <span class="sr-only">Workflow</span>
          <div>
            <svg
              width="183"
              height="51"
              viewBox="0 0 183 51"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <g clip-path="url(#clip0_2593_13223)">
                <path
                  d="M13.2757 21.1068C16.7044 21.1068 19.3355 22.2389 21.1694 24.503C23.0033 26.7275 23.9202 29.9649 23.9202 34.2152V48.2771H18.1793V34.2152C18.1793 31.5538 17.7209 29.5875 16.8039 28.3164C15.887 27.0057 14.3522 26.3502 12.1993 26.3502C10.4053 26.3502 8.87043 27.1049 7.59468 28.6144C6.3588 30.0841 5.74087 32.0305 5.74087 34.4536V48.2771H0V21.5835H5.74087V24.9202C6.25914 23.9271 7.17608 23.0532 8.4917 22.2985C9.80731 21.5041 11.402 21.1068 13.2757 21.1068Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M32.6626 48.2771V21.5835H38.4035V48.2771H32.6626Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M77.0513 21.1068C80.2805 21.1068 82.7722 22.2389 84.5264 24.503C86.3203 26.7672 87.2174 30.0046 87.2174 34.2152V48.2771H81.4765V34.2152C81.4765 31.5935 81.038 29.6272 80.1609 28.3164C79.3237 27.0057 77.9284 26.3502 75.9748 26.3502C74.1808 26.3502 72.7257 27.085 71.6093 28.5547C70.533 30.0246 69.9948 31.9908 69.9948 34.4536V48.2771H64.2539V34.2152C64.2539 31.5935 63.8153 29.6272 62.9382 28.3164C62.1011 27.0057 60.7057 26.3502 58.7523 26.3502C56.9582 26.3502 55.5031 27.085 54.3868 28.5547C53.3105 30.0246 52.7721 31.9908 52.7721 34.4536V48.2771H47.0312V21.5835H52.7721V24.9202C53.3303 24.1257 53.8486 23.51 54.327 23.073C54.8054 22.5964 55.523 22.1594 56.4798 21.7622C57.4766 21.3253 58.5927 21.1068 59.8286 21.1068C63.6161 21.1068 66.3669 22.6163 68.0811 25.6352C69.3968 23.9667 70.7124 22.795 72.028 22.1197C73.3835 21.4444 75.0579 21.1068 77.0513 21.1068Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M101.126 9.36438V24.9202C103.399 22.3778 106.269 21.1068 109.738 21.1068C113.446 21.1068 116.595 22.4772 119.186 25.2182C121.818 27.9193 123.133 31.1566 123.133 34.9302C123.133 38.7833 121.818 42.0605 119.186 44.7616C116.595 47.423 113.446 48.7536 109.738 48.7536C106.269 48.7536 103.399 47.4825 101.126 44.9403V48.2771H95.3857V9.36438H101.126ZM103.459 41.0078C105.053 42.6761 106.987 43.5103 109.259 43.5103C111.532 43.5103 113.446 42.6761 115 41.0078C116.595 39.3394 117.392 37.3136 117.392 34.9302C117.392 32.5469 116.595 30.521 115 28.8527C113.446 27.1844 111.532 26.3502 109.259 26.3502C106.987 26.3502 105.053 27.1844 103.459 28.8527C101.904 30.521 101.126 32.5469 101.126 34.9302C101.126 37.3136 101.904 39.3394 103.459 41.0078Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M141.199 48.7537C137.771 48.7537 135.139 47.6415 133.306 45.4169C131.472 43.1529 130.555 39.8955 130.555 35.6452V21.5835H136.296V36.1219C136.296 38.5451 136.754 40.3921 137.671 41.6632C138.588 42.8946 140.123 43.5104 142.276 43.5104C144.109 43.5104 145.644 42.7357 146.88 41.1866C148.116 39.6374 148.734 37.5519 148.734 34.9302V21.5835H154.475V48.2771H148.734V44.9404C148.216 45.9333 147.299 46.8271 145.983 47.6216C144.668 48.3763 143.073 48.7537 141.199 48.7537Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M174.404 31.5935C180.105 32.9044 182.955 35.8041 182.955 40.2928C182.955 42.7953 181.998 44.841 180.085 46.4299C178.21 47.9791 175.998 48.7536 173.446 48.7536C169.419 48.7536 165.892 47.2443 162.862 44.2253L165.732 40.0544C168.084 42.3186 170.536 43.4705 173.088 43.5103C174.404 43.5103 175.419 43.2124 176.137 42.6166C176.855 41.981 177.213 41.3057 177.213 40.5907C177.213 39.121 175.978 38.0286 173.506 37.3136C169.998 36.3602 167.587 35.2877 166.27 34.0961C164.955 32.8647 164.296 31.0971 164.296 28.7932C164.296 26.7275 165.095 24.94 166.689 23.4305C168.323 21.8814 170.556 21.1068 173.387 21.1068C176.257 21.1068 179.891 22.795 182.162 24.6222L179.472 28.7932C177.877 27.6808 176.137 26.3502 173.387 26.3502C172.35 26.3502 171.532 26.5686 170.936 27.0057C170.337 27.4425 170.038 27.9788 170.038 28.6144C170.038 29.3691 170.337 29.9649 170.936 30.4019C171.573 30.7991 172.729 31.1963 174.404 31.5935Z"
                  fill="#0A0A0A"
                />
                <path
                  d="M87.3365 3.49738H47.0444V9.5578H87.3365V3.49738Z"
                  fill="#F20D19"
                />
              </g>
              <defs>
                <clipPath id="clip0_2593_13223">
                  <rect
                    width="182.955"
                    height="50"
                    fill="white"
                    transform="translate(0 0.372375)"
                  />
                </clipPath>
              </defs>
            </svg>
          </div>
        </a>
      </div>
      <nav class="mt-5 flex-1 px-2 space-y-1" aria-label="Sidebar">
        <router-link
          :to=" item.href"
          @click="closeMenu"
          v-for="item in navigation"
          :key="item.name"
          :class="[
            currentRouteName === item.href.name
              ? 'bg-gray-100 text-gray-900'
              : 'text-gray-900 hover:bg-gray-100',
            'group flex items-center px-2 py-2 text-base font-medium rounded-md',
          ]"
        >
          {{ item.name }}
        </router-link>
      </nav>
    </div>
    <div class="flex-shrink-0 flex bg-gray-100 p-4">
      <a href="#" class="flex-shrink-0 w-full group block">
        <div class="flex items-center">
          <div>
            <img
              class="inline-block h-9 w-9 rounded-full"
              src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80"
              alt=""
            />
          </div>
          <div class="ml-3">
            <p class="text-sm font-medium text-gray-700">User Name</p>
            <div class="flex items-center space-x-1">
              <p class="text-xs font-medium text-teal-500 hover:underline">
                0xE881...4567
              </p>
              <DocumentDuplicateIcon class="h-4 w-4" />
            </div>
          </div>
        </div>
      </a>
    </div>
    <div class="flex flex-col items-start space-y-2 p-4">
      <a
        href="#"
        class="
          text-gray-900
          font-medium
          text-base
          font-inter
          flex
          items-center
          space-x-4
        "
      >
        <div>
          <svg
            width="21"
            height="18"
            viewBox="0 0 21 18"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <mask id="path-1-inside-1_2909_22256" fill="white">
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M3.72266 4.125H18.241C19.3082 4.125 20.1758 4.94499 20.1758 5.95312V15.7031C20.1758 16.7113 19.3082 17.5312 18.241 17.5312H3.11328C1.76694 17.5312 0.675781 16.4401 0.675781 15.0938V2.90625C0.675781 1.55991 1.76694 0.46875 3.11328 0.46875H17.1289C18.1386 0.46875 18.957 1.28722 18.957 2.29688C18.957 2.63355 18.6843 2.90625 18.3477 2.90625H3.72266C3.38598 2.90625 3.11328 3.17895 3.11328 3.51562C3.11328 3.8523 3.38598 4.125 3.72266 4.125ZM15.3008 10.8281C15.3008 11.5011 15.8466 12.0469 16.5195 12.0469C17.1925 12.0469 17.7383 11.5011 17.7383 10.8281C17.7383 10.1551 17.1925 9.60938 16.5195 9.60938C15.8466 9.60938 15.3008 10.1551 15.3008 10.8281Z"
              />
            </mask>
            <path
              d="M18.241 2.125H3.72266V6.125H18.241V2.125ZM22.1758 5.95312C22.1758 3.73525 20.3046 2.125 18.241 2.125V6.125C18.2575 6.125 18.2514 6.13019 18.2349 6.11467C18.2263 6.10653 18.2117 6.08959 18.1985 6.06028C18.1846 6.02919 18.1758 5.99127 18.1758 5.95312H22.1758ZM22.1758 15.7031V5.95312H18.1758V15.7031H22.1758ZM18.241 19.5312C20.3046 19.5312 22.1758 17.921 22.1758 15.7031H18.1758C18.1758 15.665 18.1846 15.6271 18.1985 15.596C18.2117 15.5667 18.2263 15.5497 18.2349 15.5416C18.2514 15.5261 18.2575 15.5312 18.241 15.5312V19.5312ZM3.11328 19.5312H18.241V15.5312H3.11328V19.5312ZM-1.32422 15.0938C-1.32422 17.5447 0.662374 19.5312 3.11328 19.5312V15.5312C2.87151 15.5312 2.67578 15.3355 2.67578 15.0938H-1.32422ZM-1.32422 2.90625V15.0938H2.67578V2.90625H-1.32422ZM3.11328 -1.53125C0.662374 -1.53125 -1.32422 0.455343 -1.32422 2.90625H2.67578C2.67578 2.66448 2.87151 2.46875 3.11328 2.46875V-1.53125ZM17.1289 -1.53125H3.11328V2.46875H17.1289V-1.53125ZM20.957 2.29688C20.957 0.182648 19.2431 -1.53125 17.1289 -1.53125V2.46875C17.034 2.46875 16.957 2.39179 16.957 2.29688H20.957ZM18.3477 4.90625C19.7889 4.90625 20.957 3.73812 20.957 2.29688H16.957C16.957 1.52898 17.5798 0.90625 18.3477 0.90625V4.90625ZM3.72266 4.90625H18.3477V0.90625H3.72266V4.90625ZM5.11328 3.51562C5.11328 4.28351 4.49055 4.90625 3.72266 4.90625V0.90625C2.28141 0.90625 1.11328 2.07438 1.11328 3.51562H5.11328ZM3.72266 2.125C4.49055 2.125 5.11328 2.74774 5.11328 3.51562H1.11328C1.11328 4.95687 2.28141 6.125 3.72266 6.125V2.125ZM16.5195 10.0469C16.9511 10.0469 17.3008 10.3965 17.3008 10.8281H13.3008C13.3008 12.6057 14.742 14.0469 16.5195 14.0469V10.0469ZM15.7383 10.8281C15.7383 10.3965 16.0879 10.0469 16.5195 10.0469V14.0469C18.2971 14.0469 19.7383 12.6057 19.7383 10.8281H15.7383ZM16.5195 11.6094C16.0879 11.6094 15.7383 11.2597 15.7383 10.8281H19.7383C19.7383 9.05058 18.2971 7.60938 16.5195 7.60938V11.6094ZM17.3008 10.8281C17.3008 11.2597 16.9511 11.6094 16.5195 11.6094V7.60938C14.742 7.60938 13.3008 9.05058 13.3008 10.8281H17.3008Z"
              fill="#9CA3AF"
              mask="url(#path-1-inside-1_2909_22256)"
            />
          </svg>
        </div>
        <span> My Wallet</span></a
      >
      <a
        href="#"
        class="
          text-gray-600
          font-medium
          text-base
          font-inter
          flex
          items-center
          space-x-4
        "
      >
        <div>
          <svg
            width="20"
            height="18"
            viewBox="0 0 20 18"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M9 13L5 9M5 9L9 5M5 9L19 9M14 13V14C14 15.6569 12.6569 17 11 17H4C2.34315 17 1 15.6569 1 14V4C1 2.34315 2.34315 1 4 1H11C12.6569 1 14 2.34315 14 4V5"
              stroke="#9CA3AF"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </div>
        <span>Disconect</span></a
      >
    </div>
  </div>
</template>
<script>
// import {  LockClosedIcon  } from '@heroicons/vue/solid'
import { computed, onMounted, ref } from "@vue/runtime-core";
import { useStore } from "vuex";
import { useRoute, useRouter } from "vue-router";
import { auth, storage } from "../../firebase/firebase";

const navigation = [
  { name: "My Account", href: {name:'MyAccount',params:{address:'gfdg'}} },
  { name: "My NFT", href:  {name:'My_collections'}  },
  { name: "My Vaults", href:  {name:'MyAccount',params:{address:'gfdg'}}  },
  { name: "My Fractions", href:  {name:'MyAccount',params:{address:'gfdg'}}  },
  { name: "My Purchase History", href:  {name:'MyAccount',params:{address:'gfdg'}}  },
];
export default {
  components: {
    // LockClosedIcon
  },
  computed:{
    currentRouteName() {
        return this.$route.name;
    }
  },
  setup(props) {
    const store = useStore();
    const route = useRoute();
    const router = useRouter();

    const fullName = computed(() => store.getters["user/getFullName"]);

    const email = computed(() => store.getters["user/getEmail"]);

    const avatar = ref("");

    const openModal = async () => {
      await store.dispatch("NotificationStore/SET_MODAL_TITLE", {
        title: "Are you sure you want to log out?",
      });
      await store.dispatch("NotificationStore/SET_MODAL_MESSAGE", {
        message: "",
      });
      await store.dispatch("NotificationStore/SET_MODAL_BUTTONS", {
        buttons: [
          {
            name: "Cancel",
            btnStyle: "secondary",
            action: async function () {
              await store.dispatch("NotificationStore/SET_OPEN_MODAL");
            },
          },
          {
            name: "Log out",
            action: async function () {
              logout();
              await store.dispatch("NotificationStore/SET_OPEN_MODAL");
            },
          },
        ],
      });
      await store.dispatch("NotificationStore/SET_OPEN_MODAL");
    };

    const logout = async () => {
      if (props.type == "admin") {
        await auth.signOut();
        router.push("/admin/login");
      } else {
        await store.dispatch("user/logoutUser");
        router.push("/");
      }
    };

    const getAvatar = async () => {
      const image = store.getters["user/getAvatar"];

      if (image) {
        var storageRef = storage.ref();
        const url = await storageRef.child(image).getDownloadURL();
        avatar.value = url;
      }
    };

    onMounted(async () => {
      await getAvatar();
    });

    return {
      navigation,
      route,
      currentAddress: computed(
        () => store.getters["blockchain/getCurrentAddress"]
      ),
      logout,
      fullName,
      email,
      avatar,
      openModal,
    };
  },
};
</script>